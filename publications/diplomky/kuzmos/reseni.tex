\chapter{Øešení}
V této kapitole budou popsané obecné charakteristiky programátorské
implementace v rámci této diplomové práce.
\label{implementation}
\section{Vztah k práci ''Experimentální GUHA procedury''}
Zde se podrobnì uvede vztah diplomové práce T.Kuchaøe ''Experimentální GUHA procedury''
uvedené v seznamu pouité literatury jako \cite{kuchar}.
\paragraph{}
Jak bylo podrobnì popsáno v kapitole \ref{ferdaproject}, Ferda Data\-Miner
vznikl jako studentskı projekt s cílem implementace obecnìjší platformy
pro data\-mining se základním prvkem pojmenovanım krabièka, viz \cite{ferda}
pro podrobnìjší informace.
\paragraph{}
V dobì jeho vzniku ji byly získány rozsáhlé uivatelské
zkušenosti se systémem LISp-Miner a Ferda Data\-Miner byl navren s ohledem
na tyto zkušenosti. V rámci studentského projektu byly implementovány procedury metody
GUHA s pouitím
existujících modulù prostøedí LISp-Miner. To pøineslo øadu potíi podrobnì
popsanıch T.Kuchaøem v \cite{kuchar} a proto bylo evidentní, e procedury GUHA
se musí do prostøedí Ferda Data\-Miner pøidat bez vyuití LISp-Mineru.
\paragraph{}
Implementaci šesti GUHA procedur a modulù pro zadání úlohy implementoval
T.Kuchaø ve své diplomové práci ''Experimentální GUHA procedury'',
jak u zde bylo nìkolikrát zmínìno.
\paragraph{}
Tato diplomová práce je rozšíøením existujících (tzn. v prostøedí
Ferda Data\-Miner implementovanıch) data\-miningovıch procedur. Sdílí
jak zpùsob zadávání úlohy, tak i nìkteré èásti procedur. 
\paragraph{}
Z uivatelského hlediska se relaèní rozšíøení procedur implementovaly jako
krabièky. Pøesnı popis pøidanıch krabièek je uveden v kapitole \ref{implementationdetails}.
Do relaèní procedury ve formì krabièky se zapojí zadání úlohy stejnì jako do nerelaèní
a vıstup se zapojuje do krabièek data\-miningovıch procedur stejnì jako z existujících krabièek
booleovskıch atributù.
\paragraph{}
 Z programátorského hlediska se vyuívá
prostøedkù jako získávaní bitovıch øetízkù ze zapojenıch krabièek atributù,
inicializace samotné relaèní procedury
a dalších pøedpøipravenıch prostøedkù, jako jsou roz\-hraní, abstrak\-tní tøídy apod.
Mnoho z tìchto prostøedkù bylo v prùbìhu imple\-mentace uzpùsobeno pro
relaèní data\-mining, jak bude podrob\-nìji popsáno v kapitole \ref{implementationdetails}.
Na druhou stranu pøi implementaci autor vy\-tvoøil další pro\-støedky usnad\-òující
implementaci relaè\-ních roz\-šíøení pro zbıvající data\-miningové procedury.
\paragraph{}
Vzhledem k od\-lišné povaze generování relevan\-tních otázek ne\-bylo
mo\-né vyuít jedné z hlav\-ních vıhod existující imple\-mentace
GUHA procedur v pro\-støedí Ferda Data\-Miner a to cache bitovıch
øetízkù. Dále existující imple\-mentace musela bıt roz\-šíøena
o monost práce s bitovımi øetízky na odlišném principu,
ne bylo dosud implementováno.
\paragraph{}
Monost snadné integrace a vyuití existujících prostøedkù byla od zaèátku jedním
z hlavních cílù projektu Ferda Data\-Miner. Z tohoto a dalších dùvodù
uvedenıch vıše se odvíjely zásady implementace.

\section{Zásady implementace}
Zde bude popsán obecnı programátorskı pøístup k øešení implementace.
\subsection{Licence}
Protoe prostøedí Ferda Data\-Miner je vyvíjeno pod licenci
GNU Public License (GPL), implementace v rámci dané diplomové práce
je rovnì vyvíjeno pod licenci GPL. Daná licence umoòuje
nejen volné pouití programu, ale také zaruèuje volnı pøístup
ke zdrojovému kódu programu a jeho rozšiøování pod podmínkou,
e vıslednı kód bude rovnì pod GPL licenci. Plnı text GNU
Public License lze nalézt na \verb+http://www.gnu.org/licenses/gpl.txt+.
\subsection{Platforma}
Implementace v rámci dané diplomové práce byla napsána
v jazyce C\# stejnì jako stávající implementace prostøedí
Ferda Data\-Miner. Jedním z cílù (u od doby studentského projektu)
je monost práce s prostøedím Ferda Data\-Miner na více platformách.
Pod OS Windows lze vyuít platformu Microsoft .NET Framework
(\verb+http://www.microsoft.com/cze/net/+),
na jinıch operaèních systémech (napøíklad Linux nebo
MacOS) pak prostøedí Mono (\verb+http://www.mono-project.com+).
\paragraph{}
Prostøedí Ferda Data\-Miner bylo navreno modulárnì. Jeho jednotlivé
èásti mezi sebou komunikují pøes middleware Internet Communications
Engine ICE (\verb+http://www.zeroc.com+), co je moderní alternativa
podobnému frameworku CORBA a podporuje nìkolik rozšíøenıch prog\-ramovacích
jazykù, mezi které patøí také C\#.
\subsection{Vıkonnostní testy}
Souèástí dané dip\-lomové práce je øa\-da tes\-tù
re\-laè\-ních roz\-šíøe\-ní da\-ta\-miningo\-vıch pro\-ce\-dur. Tes\-ty
se za\-mìøí na hranice únos\-nosti zadání úlohy
ve smyslu doby bìhu, na vliv veli\-kosti zpraco\-vávané
datové matice na bìh relaè\-ních roz\-šíøení a také
na dùle\-itost vyuití cache pro ge\-ne\-ro\-va\-né bi\-tové
øetízky vir\-tuálním atri\-butem. V úplnì pùvodním
návrhu implemen\-tace se s cache vùbec ne\-poèítalo
z dùvodù uvedenıch dále, proto testy za\-hrnují
i bìh úlohy s vyp\-nutou cache pro ilustraci zdùvod\-nìní
její zavedení na\-vzdory pùvod\-nímu návrhu. Testy jsou popsány
v kapitole \ref{tests}.
\subsection{Dokumentace}
\subsubsection{Uivatelská dokumentace}
Uivatelská dokumentace je zahrnutá v textu práce
jako popis implentovanıch krabièek v kapitole \ref{implementationdetails} .
\subsubsection{Programátorská dokumentace}
Obecnı návrh øešení je souèástí textu této diplomové práce.
Poznámky pøímo k detailùm implementace jsou souèástí zdrojového kódu.
Tato dokumentace mùe bıt kdykoliv vygenerována ve zvláštním souboru.
\section{Agregaèní atribut}
\subsection{Popis úlohy}
Zde bude popsána podstata úlohy, kterou bylo nutné
vyøešit pro implementaci virtuálního agregaèního atributu v prostøedí
Ferda Data\-Miner.
\paragraph{}
Jak u bylo podrobnì popsáno v sekci \ref{vattributes}, agregaèní
virtuální atribut pracuje nad vedlejší datovou matici, kde provádí
jednoduché transformace, které jsou nejèastìji implementovány jako agregaèní
funkce jazyka SQL (proto název agregaèní) pro øádky vedlejší datové matice vztahující se
k objektu v hlavní datové matici.
\subsection{Diskuze nad implementaci}
Pøi roz\-ho\-do\-vá\-ní o rozsahu imple\-men\-tova\-né funkè\-nosti agre\-gaè\-ního vir\-tuál\-ního
atri\-butu se bral v potaz fakt, e da\-le\-ko za\-jímavìjším at\-ri\-butem pro vy\-ui\-tí
v re\-laè\-ním data\-miningu je atri\-but hypotézovı. Proto po dohodì s vedoucím práce bylo
rozhodnuto naimplementovat pouze základní funkènost agregaèního virtuálního atributu.
Základní funkènost zde znamená pouze monost projekce vybraného sloupce z vedlejší datové matice
na základì zadanıch klíèù pro spojení hlavní a vedlejší datové tabulky. Není implementována
monost aplikace napøíklad agregaèních funkcí SQL.
\paragraph{}
Autor dané diplomové práce si uvìdomuje fakt, e tento atribut mùe bıt obecnìjší
ne pouze spojení dvou databázovıch tabulek dle klíèe.
V diplomové práci M.Ducháèka uvedené v seznamu pouité literatury jako \cite{duchacek} je
implementován obecnìjší pøístup k agregaènímu virtuálnímu atributu. Ve zmínìné práci
je umonìno na tomto atributu spouštìt nejen agregaèní funkce jazyka SQL, ale obecnì
lze provádìt jakoukoliv úpravu dat pomocí procedur napsanıch v jazyce C\#, jejich kód je
interpretován za bìhu.
\paragraph{}
Musí\-me si však také uvìdo\-mit, e vıše uvede\-ná funk\-ènost tvoøí
velmi pod\-stat\-nou èást dip\-lomové práce M.Ducháèka. Vzhledem k fak\-tu, e autor této
dip\-lomové práce mìl pøed sebou implemen\-taci jak hypotézového atributu, tak i tøí
dalších modulù pro dynamickou trans\-formaci atributu a jednoho modulu pro static\-kou úpravu atri\-butu,
bylo rozhodnuto naprogramovat v rámci agregaèního hypotézového atributu pouze vlastnosti, které jsou
podrobnìji popsané v kapitole \ref{implementationdetails}.



\section{Hypotézovı atribut}
Zde bude popsána podstata úlohy, kterou bylo nutné
vyøešit pro implementaci virtuálního hypotézového atributu v prostøedí
Ferda Data\-Miner. Protoe vısledná idea implementace byla
nalezena a upøesnìna a bìhem nìkolika schùzí s vedoucím diplomové
práce, autor povauje za nezbytné tuto diskuzi zde krátce uvést,
co dle jeho názoru pomùe k lepšímu pochopení dùvodù
volby návrhu, kterı nakonec pøevládl a byl tedy v rámci dané
diplomové práce naprogramován. Bude následovat rozbor
dopadu zvoleného zpùsobu pro stávající i budoucí aspekty
implementace relaèních rozšíøení v prostøedí Ferda Data\-Miner.
\subsection{Popis úlohy}
Jak u bylo podrobnì popsáno v sekci \ref{vattributes}, hypotézovı
virtuální atribut (kterému také øíkáme podúloha)
pracuje nad vedlejší datovou matici, ve které
zkoumá zajímavé vztahy pro øádky dané datové matice patøící k objektu
v hlavní datové matici. Podúloha se spustí jednou pro kadı objekt
z hlavní datové matice a hledá zajímavé vztahy nad objekty z vedlejší datové tabulky,
které se vztahují ke zkoumanému objektu z hlavní datové tabulky.
Vısledkem pro hlavní úlohu, do které je takovı virtuální atribut zapojen,
bude mnoina sloupcù obsahujících sílu nebo platnost relevantního tvrzení
pro podmnoinu øádkù z vedlejší datové tabulky -- viz obrázek \ref{fig:masterclient}.

\paragraph{}
\begin{figure}[!h]
\begin{center}
\includegraphics[width=8cm]{pics/master_client1.eps}
\end{center}
\caption{Master-detail tabulka}
\label{fig:masterclient}
\end{figure}
\paragraph{}
Zde podúloha probìhne nad transakcemi 1 a 2, vısledek (reálné èíslo) pøidá
do nového virtuálního sloupce na pozici pro klienta ABC. Dále podúloha probìhne znovu
nad transakcemi 3 a 4, pøidá na pozici pro klienta DEF další reálné èíslo a obdobnım zpùsobem
pokraèuje pro zbytek matice.
\paragraph{}
V této diplomové práci bylo implementováno relaèní rozšíøení procedur 4ft-Miner
a SD4ft-Miner. Jako vıstup úloh tìchto virtuálních atributù se generují virtuální sloupce
obsahující hodnoty \emph{true} a \emph{false}. Do prostøedí Ferda Data\-Miner však lze pøidat
i relaèní rozšíøení procedur, která budou generovat sloupce reálnıch hodnot. V následujícím popisu
implementace se takováto varianta rovnì diskutuje.
\subsection{Diskuze nad implementaci}
Z vıše popsaného je jasné, e implementace musí vyøešit nìkolik problému.
Jejich øešení bylo podrobnì diskutováno s vedoucím diplomové práce
pøiblinì v následujících bodech.
\paragraph{}
Pro zaèátek si ještì jednou pøipomeneme základní algoritmus generování
relevantních otázek a ovìøování hypotéz pro data\-miningovou proceduru 4ft-Miner.
%\clearpage
\begin{verbatim}
foreach(BitString condition in Conditions)
{
    foreach(BitString antecedent in Antecedents)
    {
        foreach(BitString succedent in Succedents)
        {
            ContingencyTable table = 
                ComputeTable(succedent, antecedent, condition);
            if (VerifyQuantifiers(table))
                result.Add(succedent, antecedent, condition);
        }
    }
}

\end{verbatim}
Objekty \verb+Antecedents+, \verb+Succedents+ a \verb+Conditions+ jsou
v pro\-støedí Ferda Data\-Miner na\-prog\-ramovány jako iterátory pos\-kytující bi\-to\-vé øe\-tíz\-ky
a tím umo\-òují prùchod pøes všech\-ny mo\-né hod\-noty za\-dání booleovskıch atri\-butù.
Pøi implemen\-taci relaè\-ních roz\-šíøení stávajících pro\-cedur by\-lo nut\-né za\-jistit
po\-skyto\-vání bi\-tovıch øe\-tízkù pro tyto iterátory (zde uvedenı pseudo\-kód lze chápat
jako bìh nad\-úlohy). Pod\-úloha ge\-neruje vir\-tuální sloup\-ce a je pot\-øeba je na\-pojit
na vıše zmínìné iterátory.
\subsubsection{Zpùsob bìhu podúlohy}
\label{subtaskimplementation}
Bìhem diskuze se diskutovaly následující tøi pøístupy, jak mùe podúloha bìet.
\begin{description}
\item[Pøedbìné generování]
Podúloha by se spouštìla pøedem na ved\-lejší dato\-vé ma\-ti\-ci. Vıs\-led\-ky ve for\-mì
buï vir\-tuál\-ních sloup\-cù a(nebo) bitovıch øe\-tíz\-kù by se pøe\-chodnì skla\-do\-valy
v pamìti èi ve for\-mì serializovanıch objek\-tù a pøi nás\-led\-ném bìhu nad\-úlohy
by se této pøed\-loily. Podob\-nım zpù\-sobem jsou implemen\-továny na\-pøík\-lad
stávající pro\-ce\-dury pro trans\-formaci atri\-butu -- ''Each value one category'', ''Ekvidistanèní intervaly''
a ''Ekvifrekvenèní intervaly''.
\paragraph{}
Vıhodou takového pøís\-tupu by by\-la mo\-nost vyuít stávající vı\-hody imple\-men\-tace
me\-tody GUHA v pro\-støedí Ferda Data\-Miner a to zejména cache bi\-tovıch øe\-tízkù.
Dále by se mohly bez vìt\-ších zmìn pouít data\-miningové pro\-cedury jako pod\-úlohy,
v pod\-statì by se jed\-nalo o jejich spuštìní na pod\-mnoinì datové matice mís\-to
na celé mno\-inì øádkù. Také takto implemen\-tovanı vir\-tuální atri\-but by šel
vy\-uit pro zadání pro všechny dosud implementované GUHA data\-miningové
procedury v prostøedí Ferda Data\-Miner.
\paragraph{}
Hlavním dùvodem napsání pøed\-chozího odstavce v pod\-miòovacím zpùsobu
se stala nemonost škálovatelnosti takového øešení. U i pro existující
vzorová data virtuální banky Barbora mohl nastat problém se zabíranou
pamìti pro vy\-generované bi\-tové øe\-tízky. Poèet re\-levantních otázek v za\-dané
data\-miningové úloze v øádu tisícù èi deseti\-tisícù je bì\-nou zá\-leitostí.
Protoe kadá rele\-vantní otázka v pod\-úloze znamená novı vir\-tuální sloupec
v hlavní tabulce, nad kterou bìí hlavní data\-miningová úloha, pøi úvaze
o veli\-kosti po\-a\-do\-vané operaèní pamìti (protoe bi\-tové øe\-tíz\-ky kra\-bièky
atri\-butù ve Fer\-da Data\-Miner ucho\-vávají právì tam) se mu\-sí po\-èet sloup\-cù
vy\-násobit poè\-tem øádkù hlavní datové matice. V relaè\-ních roz\-šíøeních
procedur v této diplomové práci se generují vir\-tuální sloupce s hod\-notami
\emph{true} nebo \emph{false}, proto vıše spoèítané èíslo by zna\-menalo
poèet bitù potøebnıch pro uchování virtuálních sloupcù, ale obecnì vir\-tuální
atributy mohou generovat sloupce s reál\-nımi hodnotami a ve\-likost pot\-øebné
pamìti se tak zvıší.
\paragraph{}
Pøi úvaze s matici banky Barbora o velikosti øádovì kolem 5000 øádku
a poètem re\-le\-vantních otázek v pod\-úloze kolem 10000 nám vzniká ještì vcelku
pøijatelná velikost zabírané RAM, nicménì je tøeba si uvìdomit, e velikost
zkoumané datové tabulky pro úlohy blíící se reálné situaci je spíše v øádech
statisícù a miliónù záznamù. Toto je zásadní omezení pro budoucí aplikace
prostøedí Ferda Data\-Miner a takto navrenı zpùsob implementace by omezil nejen
relaèní rozšíøení procedur implementovanıch v rámci dané diplomové práce,
ale i pøípad\-nıch dalších implementací relaèních rozšíøení v budoucnu.
\paragraph{}
Z vıše uvedenıch dùvodù bylo tedy od tohoto zpùsobu implementace upuštìno.
\item[Èekající procedury]Po zavrení pøedchozího pøístupu bylo jasné, e øešení
pøed\-gene\-rovat si bi\-tové øetízky do pamìti ne\-pøipadá v úvahu. Zaèal se hledat
zpùsob, jak vir\-tuální sloup\-ce a tedy i bitové øetízky, gene\-rovat prùbìnì,
vdy na pokyn nad\-úlohy.
\paragraph{}
Vznik\-la následující úvaha: protoe nad\-úloha pot\-øebo\-vala ke zpra\-cování ce\-lı
sloupec hlavní datové matice najednou, cyklus pod\-úlohy pos\-kytující bi\-to\-vé øe\-tíz\-ky
by mohl bìet v samostatném vláknì. Pod\-úloha by jako vstup\-ní ma\-ti\-ci obdrela
podmnoinu øádkù ved\-lejší datové ma\-tice pro jeden objekt z hlavní
datové matice. Tedy pro kadı objekt z hlav\-ní datové matice by bìelo
jedno vlákno pod\-úlohy, které by pos\-tupnì vra\-celo hodnoty \emph{true} nebo \emph{false}
(nebo obecnì reálná) èísla, ze kterıch by se skládaly virtuální sloupce.
\paragraph{}
Na první poh\-led je však jas\-né, e by mu\-sel bìet po\-èet vláken stej\-nı 
jako po\-èet øádkù v hlav\-ní datové matici. Idea øá\-dovì tisíce vlá\-ken pro vı\-po\-èet
by jedno\-duché úlohy (i nad tabulkou vir\-tuální banky Barbory -- viz ka\-pi\-to\-la \ref{tests})
se auto\-rovi zdála jako vel\-mi špatnı návrh z dù\-vodu pøí\-liš vel\-ké
reie operaè\-ního systému na pøe\-pínaní tako\-vého poè\-tu vlá\-ken. Z do\-savad\-ních
zkuše\-ností by\-lo vy\-po\-zo\-ro\-vá\-no, e na bìnì dostupném osobním poèítaèi øádovì i stovka vláken
vìtšinou pøedstavuje velké vytíení komponent systému.
\paragraph{}
Z vıše uvedenıch dùvodù bylo tedy od tohoto zpùsobu implementace upuštìno.
\item[Generování po krocích]
Pøedchozí úvaha však inspirovala autora práce k jinému pøístupu k øešení. Jak je vidìt
z algoritmu generování re\-le\-vantních otázek, kterı je uveden na poèátku této sekce,
data\-miningová procedura (v tomto pøípadì nad\-úloha) potøebuje v jednot\-livıch kro\-cích svıch cyklù pouze
\emph{jeden bitovı øetízek}. Z tohoto vznikla idea navrhnout data\-miningovou proceduru pro pod\-úlohu tak, aby umìla
pos\-kytnout na poádání ne nìjakı konkrétní sloupec nebo bi\-tovı øe\-tízek, nıbr \emph{další} sloupec
a \emph{další} bitovı øetízek anebo nic v pøípadì vyèerpání monıch re\-le\-vant\-ních otázek (a tím
i vir\-tuál\-ních sloupcù).
\paragraph{}
Zásadní rozdíl oproti dosud existujícím (ne\-vir\-tuálním) atri\-butùm byl ten, e tyto mìly
celou mnoinu svıch bi\-tovıch øe\-tízkù v okam\-iku pøed zaèátkem gene\-rování známou. Bitové
øetízky jsou v tìchto atri\-butech iden\-ti\-fi\-ko\-va\-tel\-né dle klíèe
skladájíciho se z id atributu a názvu
ka\-te\-go\-rie. Je znám cel\-kovı po\-èet bi\-tovıch øe\-tízkù, tudí lze sta\-novit poèet cel\-kovì vy\-ge\-ne\-ro\-va\-nıch re\-le\-vantních otázek. Je moné pøistoupit 
k jakémukoliv bitovému øetízku na základì klíèe.
\paragraph{}
Oproti tomu navrhovanı zpùsob implementace hypo\-tézo\-vého atri\-butu za\-ruèo\-val pouze to,
e ta\-kovı atribut v okam\-iku za\-vo\-lání pøís\-lušné metody buï vy\-dá dal\-ší bi\-tovı øe\-tízek
nebo oznámí, e bi\-tové øetízky u vy\-dávat nebude. Není tedy známá a snadno pøís\-tupná
celá mnoina bi\-tovıch øetízku pøed za\-èátkem gene\-rování (nad\-úlohou) re\-le\-vantních otázek.
Tudí nelze spo\-èítat ani pøed\-pokládanı poèet vy\-gene\-rovanıch re\-le\-vantních otátek,
protoe hypo\-tézovı atribut jedno\-duše reaguje buï tím, e dá dal\-ší bitovı øetízek
nebo oznámí, e øe\-tízky došly.
\paragraph{}
Vıhody tohoto øešení ve smyslu škálo\-vatel\-nosti jsou zøejmé. Pod\-úloha bìí syn\-chron\-nì
s nad\-úlohou a v pamìti se uchovává a pøedává pouze jeden vir\-tuální sloupec a jeho bi\-tovı øe\-tízek v jednom okamiku.
Poté, co nad\-úloha pøejde na další krok ge\-nerování a po\-ádá vir\-tuální atri\-but o dal\-ší bi\-tovı øe\-tízek,
tento zavolá svoji me\-todu \emph{MoveNext} a vydá další øetízek. Pøed\-chozí vy\-gene\-rované øe\-tízky
se nikde ne\-uklá\-dají a ne\-zabírají pa\-mì.
\paragraph{}
Nevıhody tohoto øešení jsou ji naznaèeny
vıše a budou pod\-robnìji probrány dále. Po dis\-kuzi s ve\-doucím diplomové práce se autor rozhodl
implementovat re\-laèní rozšíøení data\-miningovıch procedur právì tím\-to zpùsobem,
protoe pøípadné nevıhody a jinı pøís\-tup k øešení znamenaly spíše nepohodlí pro pro\-gramátora, avšak
nijak nenarušovaly princip metody GUHA jako takové. Navíc pos\-kytovaly zák\-ladní vı\-hodu
škálova\-tel\-nosti -- z principu návrhu lze za\-ruèit, e úloha skonèí i na velkıch tabulkách,
ne\-vyèerpá RAM nebo poèet po\-vole\-nıch bìících vlá\-ken v systému. Mùe se stát, e
po\-bìí delší dobu, ale skonèí ko\-rektnì.
\end{description}
\subsection{Dùsledky zvoleného zpùsobu}
Zde budou pop\-sány dùsledky, které mìlo zvo\-lené øešení implemen\-taci a spolu\-práci
s ji existujícími moduly me\-tody GUHA v pros\-tøedí Ferda Data\-Miner.
\subsubsection{Vypnutí cache bitovıch øetízku}
Nej\-podstat\-nìjším dùsledkem byla nemonost pouívat stávající cache bi\-tovıch
øetízkù. Ta to\-ti fun\-guje tak, e ucho\-vává bitové øetízky pro atributy
(pro všechny atributy je spoleèná) a v pøí\-padì potøeby vyøazuje z cache
málo pouívané bitové øe\-tízky na základì nìjaké strategie. V pøí\-padì,
e v cache potøebnı bitovı øetízek ne\-existuje, poádá o nìj pøímo
potøebnı at\-ribut na základì jedno\-znaèného iden\-tifi\-kátoru.
\paragraph{}
Jak u bylo zmínìno vıše, takovı pøís\-tup by se zvolenım zpù\-sobem implemen\-tace
ne\-fun\-goval -- pøed\-pok\-ládá to\-ti mo\-nost pøís\-tupu ke všem bi\-tovım øe\-tízkùm
atributu. Návrh hy\-potézo\-vého vir\-tuálního atri\-butu s tímto ne\-poèítá -- umí
dát pouze ''další'' bitovı øe\-tízek bez mo\-nosti zjis\-tit, kterı dal\-ší to bude, jakı
bude mít iden\-ti\-fi\-kátor, ke které kate\-gorii bude patøit atd. Z tìch\-to dù\-vodù
nešlo stávající cache pro hypo\-tézovı vir\-tuální atri\-but pouít. Pouití
cache bitovıch øetízkù u ostatních buï exis\-tujících nebo novì implemen\-tovanıch
krabièek atributù zùstalo beze zmìny, protoe se pro tyto krabièky nic ne\-zmì\-nilo.
\subsubsection{Rozdìlení na krabièky}
Další otázkou bylo, zda implemen\-tovat hypo\-tézovı vir\-tuální atribut
jako dvì krabièky nebo jednu spoleènou. Stávající ne\-virtuální
atri\-buty se v pøípadì pot\-øeby gene\-rování booleovskıch atri\-butù zapojují do kra\-bièky
''AtomSetting''. Ta zajistí gene\-rování koeficientù pro booleovskı atribut.
\paragraph{}
V pøípadì hypo\-tézového virtuál\-ního atributu by nebylo mo\-né pouít stávající krabièku
pro generování koeficientù ''AtomSetting'', protoe pracuje s po\-adav\-kem ''poskytni
pøes\-nì tento bitovı øetízek'', kdeto hypo\-tézovı atribut by umìl zpraco\-vat pouze
po\-ada\-vek ''poskytni další bitovı øetízek''. Tudí kra\-bièka pro ge\-nero\-vání koeficientù
vyuitelná pouze pro hypotézovı virtuální atribut by se musela také na\-programovat.
\paragraph{}
Po úvaze se autor rozhodl ne\-implemen\-tovat zvláštní krabièku pro ge\-nero\-vání
koeficientù pro hypo\-tézovı virtuální atribut z následujících dùvodù.
\begin{description}
\item[Potøeba pouze jednoho koeficientu] Po diskuzi s vedoucím práce
bylo rozhodnuto, e pøi ge\-nero\-vání koeficientù pro booleovskı atribut
bu\-de pot\-øeba imple\-men\-tovat pou\-ze pod\-mno\-i\-ny dél\-ky jed\-na.
Kra\-biè\-ka ''Atom\-Set\-ting'' pro hy\-po\-tézovı vir\-tuální atri\-but by byla nad\-byteèná,
pro\-toe by tam chybìlo uivatel\-ské nas\-tavení, vše se odehrávalo ''pod kapotou''.
Nebyl tedy dùvod tuto krabièku vyt\-váøet.
\item[Nadbyteèná komunikace krabièek pøes ICE] Navíc by tato krabièka, která
by se za\-pojila za hypotézovı virtuální atribut, znamenala komunikaci pøes ICE.
Protoe idea implementace spoèívá v synchronním bìhu nad- a pod\-úlohy, kde
nad\-úloha uvnitø svıch cyklù (napøíklad pro sukcedent) volá pod\-úlohu, která jí
pøedává bistringy, je potøeba zajistit toto pøedávání plynule, aby
se hlavní úloha pøíliš nezpomalovala èekáním na bitovı øetízek od pod\-úlohy.
\paragraph{}
 Protoe
ze zkušeností získanıch pøi programování prostøedí Ferda Data\-Miner ještì
jako studentského projektu autor vìdìl, e komunikace krabièek pøes
rozhraní ICE je relativnì pomalá (s ohledem na skuteènost, e na komunikaci
pøes ICE by bylo tøeba èekat pøi kadém kroku  \verb+foreach+ cyklu),
bylo rozhodnuto zajistit generování atributu
a koeficientu v jedné krabièce a tím zrychlit bìh hypotézového
virtuálního atributu.
\end{description}
\subsubsection{Buffer bitovıch øetízkù}
Pøi ladìní prvotní implementace hypotézového virtuálního atributu
se zjistilo, e aèkoliv zvolenı návrh zaruèí škálovatelnost
a jistotu toho, e úloha by za delší dobu dobìhne a nezabere
zbyteènou pamì, doba bìhu celkové úlohy je neúmìrnì dlouhá.
\paragraph{}
Dùvod dlouhého bìhu úlohy s virtuálním atributem celkem logicky spoèíval
v neexistenci jakéhokoliv cacheování bitovıch øetízkù poskytovanıch
virtuálním hypotézovım atributem. Pøi prvotním návrhu autor a vedoucí
diplomové práce na tento fakt nebrali pøíliš ohled, protoe spíše diskutovali
o dlouho\-dobìjších dopadech zvoleného zpùsobu implementace. Velkı rozdíl v rychlostech bìhu
úlohy byl ještì umocnìn faktem, e všechny dosavadní GUHA procedury byly implementovány
s pouitím cache bitovıch øetízkù a generování bitovıch øetízkù pøi bìhu úlohy probìhlo
pouze poprvé a poté se naèítaly z cache. Proto hypotézovı atribut, kterı ádnou cache
nepouíval, zpùsoboval opravdu velké zpomalení bìhu úlohy, byl-li do ni zapojen.
\paragraph{}
Podíváme-li se na algoritmus 4ft mineru uvedeného vıše a pøedstavíme-li si ho
jako nad\-úlohu, do které bude zapojen minimálnì jeden virtuální hypotézovı atribut
(napøíklad jako sukcedent), tak bude jasné, e tento algoritmus pobìí opravdu pomalu.
Zapojení virtuálního atributu do sukcedentu je pro tento miner ''nejhorší pøípad'',
protoe bitstringy jim generované jsou pouívany ve vnitøním \verb+foreach+ cyklu,
a v pøípadì nepouívaní cache to znamená, e uvnitø tohoto cyklu se \emph{pokadé} spustí
pod\-úloha (vnitøní miner), aby mohla nad\-úloze poskytnout bitstring.
\paragraph{}
Pøi vší snaze autora dané práce jakkoliv urychlit bìh úlohy se zapojenım hypotézovım
atributem vycházelo najevo, e od pùvodnì plánované implementace prosté jakéhokoliv
cacheování bude nutné upustit. Pøi krátkém otestování a optimalizaci dosud naimplementovaného
kódu krabièky autor byl schopen dosáhnout rozumné doby bìhu úlohy (v øádu desítek minut)
pøi omezení maximálního poètu virtuálních sloupcù a potamo i bitovıch øetízkù vygenerovanıch
krabièkou virtuálního atributu na 15-20. Pøi zvıšení maximálního poètu virtuálních sloupcù
na 50 doba bìhu jednoduché úlohy se pohybovala v øádu hodin.
\paragraph{}
Protoe bìné poèty vygenerovanıch re\-le\-vantních otázek v procedurách GUHA se pohybují v øádech
tisícù a desetitisícù pøi potøebné dobì bìhu spíše v øádu minut, bylo zøejmé, e
zpomalujícím faktorem byla právì absence cacheování bitovıch øetízkù pro virtuální atribut.
Bylo tedy rozhodnuto upustit od kanonického implementaèního øešení a autor naimplementoval
cache i pro virtuální atributy.
\section{Atributy}
Zde bude popsána podstata úlohy, kterou bylo nutné
vyøešit pro implementaci atributù v prostøedí
Ferda Data\-Miner. Podrobnìjší popis principù fungování danıch
atributù je uveden v dané diplomové práci v sekci \ref{cileatributy}.
\subsection{Ekvidistanèní intervaly}
V rámci implementace funkènosti tohoto atributu byly vyuity algoritmy
pro vytvoøení ekvidistanèních intervalù pøipravené T.Kuchaøem
v rámci jeho diplomové práce uvedené jako \cite{kuchar}. Tyto algoritmy
byly adaptovány z prostøedí projektu Rel-Miner T.Karbana a pøipraveny
pro vyuití v prostøedí Ferda Data\-Miner. Autor dané diplomové práce
vytvoøil pro danı atribut krabièku v prostøedí Ferda Data\-Miner,
její funkènost bude detailnì popsána v kapitole \ref{implementationdetails}.

\subsection{Ekvifrekvenèní intervaly}
V rámci implementace funkènosti tohoto atributu byly vyuity algoritmy
pro vytvoøení ekvifrekvenèních intervalù pøipravené T.Kuchaøem
v rámci jeho diplomové práce uvedené jako \cite{kuchar}. Tyto algoritmy
byly adaptovány z prostøedí projektu Rel-Miner T.Karbana a pøipraveny
pro vyuití v prostøedí Ferda Data\-Miner. Autor dané diplomové práce
vytvoøil pro danı atribut krabièku v prostøedí Ferda Data\-Miner,
její funkènost bude detailnì popsána v kapitole \ref{implementationdetails}.
\subsection{Statickı atribut}
V rámci implementace funkènosti tohoto atributu byla vytvoøena krabièka,
která umoòovala spouštìní modulu pro ruèní úpravu atributu. Atribut
(pøesnìji kategorie v atributu) mohly bıt pøedem vytvoøeny napøíklad
vıše uvedenımi krabièkami ekvidistanèních nebo ekvifrekvenèních intervalù.
\subsection{Modul pro úpravu atributu}
Tento modul je spouštìn nad krabièkou ''Statickı atribut'' a umoòuje
ruèní úpravu kategorií v atributu. Pøi ní uivatel mùe jak upravovat
ji pøedpøipravené kategorie, tak i vytváøet kategorie nové. Upravovanı
atribut mùe bıt i zcela prázdnı a kategorie mohou bıt vytvoøeny
uivatelem kompletnì od zaèátku.
\paragraph{}
Modul zaruèuje korektnost ruènì pøidanıch kategorií (zaruèí napøíklad
disjunktnost intervalù, jak je poadováno pøi tvorbì úlohy pro data\-miningovou
proceduru). Vyuívá algoritmù ji implementovanıch v rámci diplomové práce
T.Kuchaøe uvedené jako \cite{kuchar}. Funkènost tohoto modulu bude detailnì popsána
v kapitole \ref{implementationdetails}.