\chapter{Testy}
\label{tests}
V této kapitole bude prozkoumán vliv rùzných faktorù na bìh
úlohy s použitím relaèního rozšíøení dataminingové procedury.
Autor bude zkoumat vliv zejména velikosti dat a poètu vygenerovaných
virtuálních sloupcù. 
\paragraph{}
Protože implementace relaèních rozšíøení
je v prostøedí Ferda DataMiner vùbec první, bude se testovat i
celkový vliv relaèního atributu na rychlost bìhu úlohy (tj.
bude se zkoumat doba bìhu úloh totožných až na pøítomnost
virtuálního atributu v zadání úlohy). Také se ukáže, že použití
bufferu pro bitové øetízky vygenerované virtuálním atributem je z hlediska
výkonu nezbytné.

\section[Zkoumaná data]{Zkoumané datové matice}
Zkoumaná data vychází z databáze fiktivní banky ''Barbora'' používané
pùvodnì v projektu LISp-Miner a dále Ferda DataMiner. Databáze obsahuje
data o fiktivních klientech, jejich pohlaví, místa bydlištì, transakcích, pùjèkách atd.
\subsection[Hlavní matice]{Hlavní datová matice}
Hlavní datová matice s názvem ''Client\_Loans'' obsahuje údaje o jednotlivých klientech.
Následující tabulka obsahuje popis sloupcù hlavní datové matice.

\begin{table}[!h]
\begin{center}
\begin{tabular}{|l|l|l|}
\hline
Název sloupce & Typ sloupce & Popis sloupce \\
\hline
client\_id & Dlouhé celé èíslo & Identifikátor klienta  \\
\hline
loan\_id & Dlouhé celé èíslo & Identifikátor pùjèky klienta  \\
															&&	(modelována situace, \\
															&&	 kde každý klient má jednu pùjèku)\\
\hline
account\_id & Dlouhé celé èíslo & Identifikátor úètu klienta  \\
															&&	(modelována situace, \\
															&&   kde každý klient má jeden úèet)\\
\hline
date & Dlouhé celé èíslo & Datum založení úètu  \\
\hline
amount & Dlouhé celé èíslo & Velikost pùjèky  \\
\hline
duration & Dlouhé celé èíslo & Doba pùjèky  \\
\hline
payments & Dlouhé celé èíslo & Výše splátky  \\
\hline
status & text & Kvalita dluhu (subjektivní hodnocení)  \\
\hline
birth\_number & Dlouhé celé èíslo & Rodné èíslo  \\
\hline
DistrictID & Dlouhé celé èíslo & Identifikátor bydlištì  \\
\hline
District & text & Bydlištì \\
\hline
Region & text & Region \\
\hline
Inhabitants & Dlouhé celé èíslo & Poèet obyvatel  \\
\hline
Muni499 & Dlouhé celé èíslo & Poèet obcí v regionù  \\
														&& s maximálnì 499 obyvateli \\
\hline
Muni1999 & Dlouhé celé èíslo & Poèet obcí v regionù  \\
														&& s maximálnì 1999 obyvateli \\
\hline
Muni9999 & Dlouhé celé èíslo & Poèet obcí v regionù  \\
														&& s maximálnì 9999 obyvateli \\
\hline
MuniOver & Dlouhé celé èíslo & Poèet obcí v regionù  \\
														&& s více než 9999 obyvateli \\

\hline
Cities & Dlouhé celé èíslo & Poèet mìst v regionu \\
\hline
PopulationRation & Dlouhé celé èíslo &??\\
\hline
Salary & Dlouhé celé èíslo & Prùmìrný plat v regionu\\
\hline
Unemployment95 & Dlouhé celé èíslo & Nezamìstnanost v regionu v roce 1995\\
\hline
Unemployment96 & Dlouhé celé èíslo & Nezamìstnanost v regionu v roce 1996\\
\hline
EnterpreneursRation & Dlouhé celé èíslo & Podnikatelé v regionu \\
\hline
Crimes95 & Dlouhé celé èíslo & Kriminalita v regionu v roce 1995\\
\hline
Crimes96 & Dlouhé celé èíslo & Kriminalita v regionu v roce 1996\\
\hline
\end{tabular}
\end{center}
\caption{Sloupce hlavní datové matice ''Client\_Loans''}
\end{table}
\clearpage



\subsection[Vedlejší matice]{Vedlejší datová matice}
Vedlejší datová matice ''trans\_pro\_client\_loan'' obsahuje transakce pro klienty
z tabulky ''Client\_Loans''. Pro úèely testování je tato tabulka obsažena
v databází ve tøech verzích: malá, støední a velká, kde poèet øádkù 
pro jednotlivé verze je
pøibližnì 10000, 70000 a 200000.
\paragraph{}
Následující tabulka obsahuje popis sloupcù vedlejší datové matice.

\begin{table}[!h]
\begin{center}
\begin{tabular}{|l|l|l|}
\hline
Název sloupce & Typ sloupce & Popis sloupce \\
\hline
trans\_id & Dlouhé celé èíslo & Identifikátor transakce  \\
\hline
client\_id & Dlouhé celé èíslo & Identifikátor klienta  \\
\hline
account\_id & Dlouhé celé èíslo & Identifikátor úètu  \\
\hline
date & Dlouhé celé èíslo & Datum transakce  \\
\hline
type & text & Typ transakce (pøíjem, výdej nebo výbìr)  \\
\hline
operation & text & Typ operace (pøevod z / na úèet, výbìr,  \\
&&vklad nebo výbìr kartou)  \\
\hline
Amount & Dlouhé celé èíslo & Velikost transakce  \\
\hline
Balance & Dlouhé celé èíslo & Zùstatek ??  \\
\hline
k\_symbol & Dlouhé celé èíslo & Konstatní symbol (úèel transakce, napø. inkaso)  \\
\hline
bank & text & Zdrojová nebo cílová banka transakce  \\
\hline
account & Dlouhé celé èíslo & Zdrojový nebo cílový úèet transakce  \\
\hline
\end{tabular}
\end{center}
\caption{Sloupce vedlejší datové matice ''trans\_pro\_client\_loan''}
\end{table}

\section[Úloha]{Východiska zadání a zadaná úloha}
Základní inspirací pro úlohu pro relaèní 4FT a SD4FT bylo zjistit nìjaké údaje
o objektech z hlavní datové matice na základì údajù z vedlejší datové matice.
V našem pøípadì hledáme nìjaké vztahy v matici klientù na základì údajù
jak v hlavní matici klientù, tak i ve vedlejší matici jejich transakcí.
Pro SD4FT zkoumáme rozdíly mezi dvìma množinami.
\paragraph{}
Na základì údajù obsažených ve zkoumaných datových maticích a po diskuzi
s vedoucím práce bylo rozhodnuto zaèít od jednodušších úloh pro
relaèní proceduru a zapojovat je do úlohy pro bìžný 4ft Miner. V úlohách se zkoumá
status úvìru v závislosti na rùzných parametrech.

\subsection[4FT atribut]{4FT virtuální boolský atribut}
\subsubsection[Úloha 1]{Úloha 1}
Úloha je zadaná pro 4ft miner následujícím zpùsobem:

\begin{equation*}
District \& Salary \& \emph{TypeImplAmount} \Rightarrow_{90\%} LoanStatus
\end{equation*}

$\Rightarrow_{90\%}$ je v tomto pøípadì kvantifikátor fundované implikace $Founded implication$
a \emph{TypeImplAmount} je virtuální 4ft atribut s následujícím zadáním:

\begin{equation*}
Type \Rightarrow_{?} Amount
\end{equation*}

$\Rightarrow$ je v tomto pøípadì rovnìž kvantifikátor
fundované implikace $Founded implication$.


\subsection[Výsledky testù]{Výsledky testù}
V následujících tabulkách jsou uvedeny doby bìhu úloh
s rùznými velikostmi vedlejší datové matice a poètem relevantních
otázek vygenerovaných relaèním 4ft booleovským atributem.
\paragraph{}
Každý test se pouštìl tøikrát a výsledný èas se zprùmìroval. Mezi každým spuštìním
Ferda DataMiner byl znovu spuštìn, aby byly zachovány stejné podmínky pro jednotlivé
bìhy (bez tohoto by se pøi druhém a dalším spuštìní naèítaly informace pro krabièky z cache).
\subsubsection{Úloha 1}
\begin{table}[!h]
\begin{center}
\begin{tabular}{|l|l|l|l|l|}
\hline
Transakce / & malé & støední &  velké  & bez rel. atributu \\
\# rel.otazek&&&&\\
\hline
16 & 14s & 25s & 1m 10s&\\
\hline
50 & 15s & 25s & 1m 32s &\\
\hline
80 & 9m 2s & 11m 11s& 12m 2s&\\
\hline
100 & 12m & 24m & 1h 3m &\\
\hline
\end{tabular}
\end{center}
\caption{Test relaèního 4ft mineru: úloha 1}
\end{table}


\section[SD4FT atribut]{SD4FT virtuální boolský atribut}
\subsection[Úloha]{Východiska zadání a zadaná úloha}
Úloha je zadaná pro 4ft miner následujícím zpùsobem:

\begin{equation*}
District \& Salary \& \emph{TypeImplAmountBank} \Rightarrow_{90\%} LoanStatus
\end{equation*}

$\Rightarrow_{90\%}$ je v tomto pøípadì kvantifikátor fundované implikace $Founded implication$
a \emph{TypeImplAmountBank} je virtuální SD4ft atribut s následujícím zadáním:

\begin{equation*}
Type \Rightarrow_{?} Amount (Bank)
\end{equation*}

$\Rightarrow$ je v tomto pøípadì rovnìž kvantifikátor
fundované implikace $Founded implication$.
\subsection[Výsledky testù]{Výsledky testù}
V následujících tabulkách jsou uvedeny doby bìhu úloh
s rùznými velikostmi vedlejší datové matice a poètem relevantních
otázek vygenerovaných relaèním SD4ft booleovským atributem.
\subsubsection{Úloha 1}
\begin{table}[!h]
\begin{center}
\begin{tabular}{|l|l|l|l|l|}
\hline
Transakce / & malé & støední &  velké  & bez rel. atributu \\
\# rel.otazek&&&&\\
\hline
16 &&&&\\
\hline
100 &&&&\\
\hline
1000 &&&&\\
\hline
\end{tabular}
\end{center}
\caption{Test relaèního SD4ft mineru: úloha 1}
\end{table}

\section{Závìr}
Z provedených testù plyne, že doba bìhu pro obì úlohy záleží hlavnì
na poètu vygenerovaných virtuálních sloupcù. Velikost vedlejší datové matice
sice má na úlohu vliv, ale zøejmì není ani lineární. To vyplývá ze zpùsobu,
jakým virtuální atribut funguje: pøi prvním generování spoèítá bitové øetízky
a uloží si je do bufferu, pøi dalších voláních se pracuje s bufferem. Proto
pøi rùzných velikostech vedlejší datové matice se úmìrnì mìní pouze
doba prvního generování.