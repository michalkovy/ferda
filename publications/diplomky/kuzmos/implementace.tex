\chapter{Implementace}
V této kapitole budou uvedeny a popsány implementované
procedury a krabièky vèetnì uvedení nìkterıch nejdùleitìjších
detailù implementace.

\label{implementationdetails}
\section{Agregaèní atribut}
Podrobnìjší popis úèelu virtuálního agregaèního atributu
byl uveden v pøed\-chozích kapitolách. Zde podrobnì probereme
naimplementovanou funkènost vèetnì popisu vytvoøené krabièky.
\subsection{Detaily implementace}
Agregaèní virtuální atribut poskytuje monost spojit dvì
datové matice (databázové tabulky) na základì zadaného klíèe
a volby vısledného sloupce z vedlejší datové matice.
Vıslednı sloupec lze zapojit do dataminingové úlohy GUHA stejnì jako
vıslednı sloupec, kterı poskytuje krabièka ''Sloupec''.
\paragraph{}
Dále danı atribut mùe v budoucnu vyuívat monosti práce s SQL funkcemi
díky pouití stejného postupu jako pøi nadefinování odvozeného sloupce.
Tato funkènost však nebyla implementována z dùvodu pracnosti, ale
mùe bıt lehce doplnìna pozdìji -- pravdìpodobnì autorem dané diplomové práce
mimo diplomovou práci, ale v rámci dalšího rozšíøování prostøedí
Ferda DataMiner.
\subsection{Krabièka}
Daná krabièka reprezentuje vıše popsanı agregaèní
virtuální atribut z uivatelského hlediska.
\subsubsection{Seznam zásuvek}
\begin{description}
\item[Hlavní datová tabulka] 
Do této zásuvky se zapojuje krabièka reprezentující hlavní
datovou matici.
\item[Vedlejší datová tabulka]
Do této zásuvky se zapojuje krabièka reprezentující vedlejší
datovou matici.
\end{description}
\subsubsection{Seznam vlastností}
\begin{description}
\item[Sémantika] 
Umoní vybrat sémantiku sloupce. Sémantika v prostøedí Ferda DataMiner
byla podrobnìji popsána v \ref{datasemantics}. Uivatel mùe tedy vybrat
z moností \emph{Nominální, Ordinální, Cyklickı ordinální, Kardinální}.
\item[Id sloupec hlavní datové tabulky] 
Zde se vybere sloupec ze seznamu na\-bízenıch sloupcù hlavní datové tabulky.
Záznamy z daného sloupce budou pouíty jako klíèe pro záznamy z hlavní datové tabulky
pøi spojení hlavní a vedlejší datové tabulky.
\item[Id sloupec vedlejší datové tabulky] 
Zde se vybere sloupec ze seznamu na\-bízenıch sloupcù hlavní datové tabulky.
Záznamy z daného sloupce budou pouíty jako klíèe pro záznamy z vedlejší datové tabulky
pøi spojení hlavní a vedlejší datové tabulky.
\end{description}
\subsubsection{Seznam vlastností pouze pro ètení}
Vlastnosti pouze pro ètení obecnì v prostøedí Ferda DataMiner
slouí k informování uivatele o vlastnostech zkoumané krabièky.
\paragraph{}
Vlastnosti pouze pro ètení pro danou krabièku jsou shodné s vlastnostmi pro ètení
krabièky ''Sloupec''.
\begin{description}
\item[Datovı typ] 
Zobrazí datovı typ hodnot záznamù ve sloupci.
\item[Prùmìr] 
Zobrazí prùmìr hodnot záznamù ve sloupci.
\item[Navzájem rùzné hodnoty] 
Zobrazí poèet záznamù s navzájem rùznımi hodnotami ve sloupci.
\item[Maximum] 
Zobrazí maximální hodnotu ze všech hodnot záznamù ve sloupci.
\item[Minimum] 
Zobrazí minimální hodnotu ze všech hodnot záznamù ve sloupci.
\item[Standardní odchylka] 
Zobrazí hodnotu standardní odchylky ze všech hodnot záznamù ve sloupci.
\item[Variabilita] 
Zobrazí hodnotu variability ze všech hodnot záznamù ve sloupci.
\end{description}

\section{Hypotézovı atribut}
Podrobnìjší popis úèelu virtuálního hypotézového atributu
byl uveden v pøed\-chozích kapitolách. Zde podrobnì probereme
naimplementovanou funkènost vèetnì popisu vytvoøenıch krabièek.
\subsection{Detaily implementace}
Hypotézovı virtuální atribut generuje virtuální sloupce (pøesnìji pøímo 
bitové øetízky) na základì zadání podúlohy. Tato se zadává obdobnì jako
bìná dataminingová úloha pro ji existující procedury. Rozdílem
je pøedevším poskytovanı vısledek. Hypotézovı virtuální atribut
neposkytuje vısledek pro prohlíení uivatelem (narozdíl od bìnıch
nerelaèních minerù), ale pro nerelaèní dataminingovou proceduru,
do které je zapojen jako booleovskı atribut.
\paragraph{}
Jako souèást implementace hypotézového virtuálního atributu v prostøedí
Ferda DataMiner byly vytvoøeny krabièky pro 4ft virtuální atribut a 
SD4ft virtuální atribut. Rovnì byly provedeny rozsáhlé úpravy backendu.
\paragraph{}
Jak u bylo zmínìno v \ref{subtaskimplementation}, krabièky 4ft- a SD4ft
virtuálního atributu generují rovnou bitové øetízky pro druh koeficientu
''jednoprvková podmnoina''. V prostøedí Ferda DataMiner proto vystupují na místì
krabièky jak ''AtomSetting'', tak krabièky atributu.
\subsubsection{Generování kolekce}
Pøi implementování dle návrhu z \ref{subtaskimplementation} se autor rozhodl vyuít
novıch vlastností, které nabízel jazyk C\# ve verzi 2.0 a to konkrétnì zavedení
klíèovího slova \verb+yield+ pro velmi snadné implementování
iterátoru (více viz na\-pøí\-klad na \verb+http://msdn2.microsoft.com/en-us/library/9k7k7cf0.aspx+).
\paragraph{}
Tato vlastnost nového C\# usnadnila implementování pøístupu ''poskytni další bitovı øetízek'',
protoe velmi zjednodušenì øeèeno umoòuje vrátit kolekci prvkù, kterou lze procházet
pomocí cyklu foreach, ani by byly dopøedu známé prvky v dané kolekci. Ta se
totí generuje dynamicky, co se nám hodí právì pøi implementaci kolekce bitovıch øetízkù,
které jsou ziskávany metodou ''poskytni další bitovı øetízek''.

\subsubsection{Count vector}
Pro generování bitového øetízku správné délky (tzn. stejné délky jako bitové
øetízky v nadúloze) je nutné vìdìt, kolik øádkù z vedlejší datové matice se váe
k objektu z hlavní datové matice. Potom bude moné generovat virtuální sloupec
správné délky - viz \ref{subtaskimplementation}.
\paragraph{}
Tato informace je ziskávana pomocí tzv. \emph{CountVectoru}, kterı na $i$-té pozici
obsahuje poèet øádkù vedlejší datové matice patøicích $i$-tému objektu z hlavní
datové matice (to samozøejmì pøedpokládá setøídìní obou matic dle stejného klíèe).
\paragraph{}
Za pouití \emph{CountVectoru} lze generovat celı virtuální sloupec, potamo odpovídajicí
bitovı øetízek, ji pomìrnì snadno.
\subsubsection{Cache bitovıch øetízkù}
Z dùvodù zmínìnıch v \ref{subtaskimplementation} byla naimplementována jiná caché
pro bitové øetízky generované hypotézovımi atributy. Dle principu fungování
je to spíše buffer ne cache -- uchová prvních N bitovıch øetízkù vygenerovanıch
hypotézovım atributem, které mohou bıt poté pouity pro bìh nadúlohy. Velikost N
byla stanovena po øadì, protoe, jak bylo zjištìno pøi implementaci dané diplomové práce,
ani pùvodní cache pro bitové øetízky neobsahuje ádnou logiku pro stanovení své velikosti.
\subsubsection{Úprava existujících dataminingovıch procedur}
Existující dataminingové procedury musely bıt rozšíøeny o metody umoòující
generování a verifikaci relevantních otázek, bez generování hypotéz a s implementaci
vıše zmínìného enumerátoru. Rovnì bylo nutné rozšíøit dataminingové procedury
o monost práce s jinım druhém cache pro bitové øetízky.
\subsubsection{Pøínos pro budoucí implementace}
Vıše uvedené postupy jsou navreny a implementovány co nejobecnìji. Autorùm implementace
relaèních rozšíøení dalších datamingovıch procedur se tímto velmi ulehèuje práce.
Mohou pouívat cache pro bitové øetízky virtuálních atributù, CountVector a další
navrené postupy.

\subsection{Krabièky}
\subsubsection{Krabièka 4ft virtuální booleovskı atribut}
Daná krabièka reprezentuje vıše popsanı hypotézovı
virtuální atribut z uivatelského hlediska.
\subsubsection{Seznam zásuvek}
Zásuvky jsou shodné s krabièkou ''4ft Miner'' a na vıjimky, jejich popis následuje.
\begin{description}
\item[Hlavní datová tabulka] 
Do této zásuvky se zapojuje krabièka reprezentující hlavní
datovou matici.
\end{description}
\subsubsection{Seznam vlastností}
Vlastnosti jsou shodné s krabièkou ''4ft Miner'' a na vıjimky, jejich popis následuje.
\begin{description}
\item[Maximální poèet relevantních otázek]
Zde se zadává maximální poèet relevantních otázek, které mùe virtuální atribut vygenerovat.
\end{description}

\subsubsection{Krabièka SD4ft virtuální booleovskı atribut}
Daná krabièka reprezentuje vıše popsanı hypotézovı
virtuální atribut z uivatelského hlediska.
\subsubsection{Seznam zásuvek}
Zásuvky jsou shodné s krabièkou ''SD4ft Miner'' a na vıjimky, jejich popis následuje.
\begin{description}
\item[Hlavní datová tabulka] 
Do této zásuvky se zapojuje krabièka reprezentující hlavní
datovou matici.
\end{description}
\subsubsection{Seznam vlastností}
Vlastnosti jsou shodné s krabièkou ''SD4ft Miner'' a na vıjimky, jejich popis následuje.
\begin{description}
\item[Maximální poèet relevantních otázek]
Zde se zadává maximální poèet relevantních otázek, které mùe virtuální atribut vygenerovat.
\end{description}


\section{Ekvidistanèní intervaly}
Z dùvodù popsanıch v \ref{zmenazadani} byla implementována krabièka atributu
pro generování ekvidistanèních intervalù.
\subsection{Detaily implementace}
Implementace krabièky vyuívá algoritmù, které byly pøipraveny T.Kucharem
v rámci diplomové práce \cite{kuchar} a pùvodnì pocházejí od T.Karbana - viz
\cite{relminer}. Autor se proto soustøedil na implementování samotné krabièky.
\subsection{Krabièka}
\subsubsection{Seznam zásuvek}

\begin{description}
\item[Sloupec] 
Do této zásuvky se zapojuje krabièka reprezentující sloupec dat, nad kterım budou
vytvoøeny ekvidistanèní intervaly.
\end{description}
\subsubsection{Seznam vlastností}
\begin{description}
\item[Poèet kategorií]
Zde se zadává poèet intervalù, které má atribut vygenerovat.
\item[X kategorie]
Zde se zadává kategorie chybìjící informace.
\item[Doména]
Zde se zadává typ vybrané domény sloupce transformováné do kategorií. 
Uivatel mùe vybrat z monosti ''Celá aktuální doména'' a ''Uivatelem definována doména''.
První monost nastaví vytváøení kategorie pro kadou hodnotu z aktuální domény sloupce,
druhá monost nastaví omezení pro pouitou doménu na základì hodnot vlastností ''Od'' a ''Do''.
\item[Od]
Pøi zvolení uivatelem definované domény kategorie budou vytvoøeny pouze
pro hodnoty z aktuální domény sloupce, které jsou vìtší nebo rovny hodnotì dané vlastnosti.
\item[Do]
Pøi zvolení uivatelem definované domény kategorie budou vytvoøeny pouze
pro hodnoty z aktuální domény sloupce, které jsou menší nebo rovny hodnotì dané vlastnosti.
\item[Název v literálech] Atribut je uveden v hypotézách pod danım názvem.
\item[Sémantika] 
Umoní vybrat sémantiku sloupce. Sémantika v prostøedí Ferda DataMiner
byla podrobnìji popsána v \ref{datasemantics}. Uivatel mùe tedy vybrat
z moností \emph{Nominální, Ordinální, Cyklickı ordinální, Kardinální}.
\end{description}


\section{Ekvifrekvenèní intervaly}
Z dùvodù popsanıch v \ref{zmenazadani} byla implementována krabièka atributu
pro generování ekvifrekvenèních intervalù.
\subsection{Detaily implementace}
Implementace krabièky vyuívá algoritmù, které byly pøipraveny T.Kucharem
v rámci diplomové práce \cite{kuchar} a pùvodnì pocházejí od T.Karbana - viz
\cite{relminer}. Autor se proto soustøedil na implementování samotné krabièky.
\subsection{Krabièka}
\subsubsection{Seznam zásuvek}

\begin{description}
\item[Sloupec] 
Do této zásuvky se zapojuje krabièka reprezentující sloupec dat, nad kterım budou
vytvoøeny ekvifrekvenèní intervaly.
\end{description}
\subsubsection{Seznam vlastností}
\begin{description}
\item[Poèet kategorií]
Zde se zadává poèet intervalù, které má atribut vygenerovat.
\item[X kategorie]
Zde se zadává kategorie chybìjící informace.
\item[Doména]
Zde se zadává typ vybrané domény sloupce transformováné do kategorií. 
Uivatel mùe vybrat z monosti ''Celá aktuální doména'' a ''Uivatelem definována doména''.
První monost nastaví vytváøení kategorie pro kadou hodnotu z aktuální domény sloupce,
druhá monost nastaví omezení pro pouitou doménu na základì hodnot vlastností ''Od'' a ''Do''.
\item[Od]
Pøi zvolení uivatelem definované domény kategorie budou vytvoøeny pouze
pro hodnoty z aktuální domény sloupce, které jsou vìtší nebo rovny hodnotì dané vlastnosti.
\item[Do]
Pøi zvolení uivatelem definované domény kategorie budou vytvoøeny pouze
pro hodnoty z aktuální domény sloupce, které jsou menší nebo rovny hodnotì dané vlastnosti.
\item[Název v literálech] Atribut je uveden v hypotézách pod danım názvem.
\item[Sémantika] 
Umoní vybrat sémantiku sloupce. Sémantika v prostøedí Ferda DataMiner
byla podrobnìji popsána v \ref{datasemantics}. Uivatel mùe tedy vybrat
z moností \emph{Nominální, Ordinální, Cyklickı ordinální, Kardinální}.
\end{description}

\section{Statickı atribut}
Z dùvodù popsanıch v \ref{zmenazadani} byla implementována krabièka
statického atributu, která umoní ruèní úpravu kategorií v atributu.
\subsection{Detaily implementace}
Daná krabièka v podstaté zajišuje spouštìní modulu pro úpravu atributu
a pøedává upravenı atribut pro další vyuití v prostøedí Ferda DataMiner.
Podstatná funkènost je soustøedìná v modulu pro úpravu atributu.
\subsection{Krabièka}
\subsubsection{Seznam zásuvek}

\begin{description}
\item[Sloupec nebo atribut] 
Do této zásuvky se zapojuje buï krabièka reprezentující sloupec dat nebo krabièka
nìkterého z atributù. Pøi zapojení krabièky atributu budou pro modul pro úpravu kategorií
poskytnuty ji vytvoøené kategorie ze zapojené krabièky.
\paragraph{}
Pøi zapojení krabièky reprezentující
sloupec není pøedem vytvoøena ádná kategorie, tudí uivatel musí pouít
modul pro úpravu kategorií pro vytvoøení kategorií. Krabièka reprezentující sloupec v tomto pøípadì
poskytuje informace o datech ve sloupci (dùleité jsou napøíklad všechny navzájem rùzné hodnoty
ze zapojeného sloupec, ale i jiné informace a vlastnosti).
\end{description}
\subsubsection{Seznam vlastností}
\begin{description}

\item[Úprava kategorií]
Pøi kliknutí na tlaèítko spustí modul pro úpravu kategorií.

\item[X kategorie]
Zde se zadává kategorie chybìjící informace.
\item[Doména]
Zde se zadává typ vybrané domény sloupce transformováné do kategorií. 
Uivatel mùe vybrat z monosti ''Celá aktuální doména'' a ''Uivatelem definována doména''.
První monost nastaví vytváøení kategorie pro kadou hodnotu z aktuální domény sloupce,
druhá monost nastaví omezení pro pouitou doménu na základì hodnot vlastností ''Od'' a ''Do''.
\item[Od]
Pøi zvolení uivatelem definované domény kategorie budou vytvoøeny pouze
pro hodnoty z aktuální domény sloupce, které jsou vìtší nebo rovny hodnotì dané vlastnosti.
\item[Do]
Pøi zvolení uivatelem definované domény kategorie budou vytvoøeny pouze
pro hodnoty z aktuální domény sloupce, které jsou menší nebo rovny hodnotì dané vlastnosti.
\item[Název v literálech] Atribut je uveden v hypotézách pod danım názvem.
\item[Sémantika] 
Umoní vybrat sémantiku sloupce. Sémantika v prostøedí Ferda DataMiner
byla podrobnìji popsána v \ref{datasemantics}. Uivatel mùe tedy vybrat
z moností \emph{Nominální, Ordinální, Cyklickı ordinální, Kardinální}.

\end{description}


\subsubsection{Seznam vlastností pouze pro ètení}
\begin{description}
\item[Poèet kategorií]
Zobrazí aktuální poèet kategorií v daném atributu.
\end{description}


\section{Modul pro úpravu atributu}
Tento modul se spouští nad krabièkou ''Statickı atribut''. Ta mu poskytuje
ji existující kategorie v atributu pro úpravu a po skonèení práce
modulu opìt uloí úpravené kategorie pro další vyuití v prostøedí Ferda DataMiner.

\subsection{Funkènost}
\subsubsection{Hlavní obrazovka}
\begin{center}
\includegraphics[width=14cm]{pics/editcategories_main.eps}
\end{center}
Zde je zobrazen seznam existujících kategorií. Kategorie mùe bı pøejmenována 
standardním postupem pro pøejmenování poloky v seznamu GUI MS Windows, tj. dvojím pomalım
kliknutím na její název, pøípadnì kliknutím na název a stisknutím klavesy F2 a poté zadáním nového názvu.
Protoe kategorie musí mít navzájem rùzné názvy, po zadání nesprávného (ji existujícího názvu)
bude oznámena chyba a kategorie se nepøejmenuje.
\begin{center}
\includegraphics[width=14cm]{pics/editcategories_rename.eps}
\end{center}
\paragraph{}
Více kategorií mùe bıt spojeno do jedné tak, e s podrením tlaèítka Control pøípadnì Shift
a kliknutím na poadované kategorie se vybere více kategorií a pak kliknutím na tlaèítko ''Spojit''
se spojí do jedné kategorie.
\paragraph{}
Kategorie mùe bıt odstranìna z atributu vybraním a následnım kliknutím na tlaèítko ''Odstranit''.
\paragraph{}
Provedené zmìny v seznamu kategorié se uloí kliknutím na tlaèítko ''Uloit a zavøit''. Pokud
je potøeba ukonèit práci modulu bez uloení zmìn, pouije se tlaèítko ''Zavøit bez uloení''.
\subsubsection{Obrazovka pro pøidání a úpravu intervalù}
\begin{center}
\includegraphics[width=14cm]{pics/editcategories_intervals.eps}
\end{center}
Uivatel mùe pøidat novou kategorií do seznamu kategorií v atributu. Z definice kategorie v metodì GUHA
a její následného rozšíøení T.Kuchaøem v \cite{kuchar} plyne, e kategorie mùe obsahovat
intervaly a vıèet hodnot.
\paragraph{}
Pøi vyvolání obrazovky pro pøidání intervalù se uivatel dostane rovnou na pøidání intervalù
do novì vytvoøené kategorie. Ve formuláøí uivatel vybere typy hranic intervalu a hodnoty krajních bodù,
poté kliknutím na tlaèítko ''Pøidat do kategorie'' pøidá interval do kategorie. Tento se poté zobrazí
v seznamu intervalù dané kategorie a mùe bıt odebrán dvojitım kliknutím na nìm.
\paragraph{}
Pøi pøidávání se kontroluje validita kategorie v atributu. Pro pøidávanı interval to tedy znamená,
e se zkontroluje jeho disjunktnost se stávajícimi intervaly v kategoriích a také s hodnotami ve
vıètech kategorií. Pokud by pøidávanı interval nebyl disjunktní s prvky existujících kategorií,
modul oznámí chybu a nedovolí takovı interval do kategorie pøidat.
\paragraph{}
Po pøidání intervalù do novì vytváøené kategorie lze potvrdit pøidání kategorie tlaèítkem ''OK''.
Pro zrušení pøidání kategorie se pouije tlaèítko ''Storno''.
\paragraph{}
Obrazovka pro úpravu intervalù v ji existující kategorii se liší tím, e nelze zmìnit název kategorie
(ten lze zmìnit v hlavní obrazovce). Logika pøi úpravì intervalù v kategorii je stejná jako je popsáno vıše.
\subsubsection{Obrazovka pro pøidání a úpravu vıètu}
\begin{center}
\includegraphics[width=14cm]{pics/editcategories_enum.eps}
\end{center}
Pøi vyvolání obrazovky pro pøidání vıètu se uivatel dostane rovnou na pøidání hodnot do vıètu
novì vytvoøené kategorie. Ve formuláøí uivatel mùe vybrat zatím nepokryté hodnoty ve sloupci
a pøidat je do vıètu novì vytváøené kategorie kliknutím na pøíslušné tlaèítko. Hodnota
se poté objeví ve vıètu hodnot dané kategorie. Odtud mùe bıt odstranìna kliknuím na pøíslušné
tlaèítko.
\paragraph{}
Po pøidání intervalù do novì vytváøené kategorie lze potvrdit pøidání kategorie tlaèítkem ''OK''.
Pro zrušení pøidání kategorie se pouije tlaèítko ''Storno''.